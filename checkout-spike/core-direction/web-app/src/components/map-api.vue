<template>
  <div>
    <gmap-map
      :center="{lat:39.933049, lng:32.858912}"
      :zoom="6"
      :options="mapOptions"
      style="width: 100%; height: 100vh"
    >
      <gmap-marker
        v-for="(m, index) in markers"
        :key="index"
        :position="m.position"
        :option="MarkerOptions"
        :icon="{ url: require('../../public/assets/images/marker-icon.png')}"
        @click="toggleInfoWindow(m, index)"
      />
      <gmap-info-window
        :options="infoOptions"
        :position="infoWindowPos"
        :opened="infoWinOpen"
        @closeclick="infoWinOpen=false"
      >
        <div v-html="infoContent" />
      </gmap-info-window>
    </gmap-map>
  </div>
</template>

<script>
import { Map } from "vue2-google-maps";
import BG from "../../public/assets/images/bg-01.jpg";
export default {
    name: "MapAPi",
    components: {
        "gmap-map": Map
    },
    data() {
        return {
            image:BG,
            center:{lat:39.933049, lng:32.858912},
            mapOptions:{
                fullscreenControl:false,
                zoomControl: true,
                mapTypeControl: false,
                scaleControl: false,
                streetViewControl: false,
                rotateControl: false,
                disableDefaultUi: false,
            },
            map: null,
            infoContent: "",
            infoWindowPos: {
                lat: 0,
                lng: 0
            },
            infoWinOpen: false,
            currentMidx: null,
            fullscreenControl:false,
            infoOptions: {
                pixelOffset: {
                    width: 0,
                    height: -35
                }
            },
            MarkerOptions:{
                zIndex:999999,
                opacity:0.2
        
            },
            markers:
      [
          {
              name: "Device 1",
              location: "location 1",
              position: {lat:39.933049, lng:32.858912}
          },
          {
              name: "Device 2",
              location: "location 2",
              position: {lat:41.008298, lng:28.978358}
          },
          {
              name: "Device 3",
              location: "location 3",
              position: {lat:41.026179, lng:28.623623}
          },
          {
              name: "Device 4",
              location: "location 4",
              position: {lat:40.979438, lng:29.061335}
          },
      ],
        };
    },
  
    methods: {
        toggleInfoWindow: function (marker, idx) {
            this.infoWindowPos = marker.position;
            this.infoContent = this.getInfoWindowContent(marker);
      
            //check if its the same marker that was selected if yes toggle
            if (this.currentMidx == idx) {
                this.infoWinOpen = !this.infoWinOpen;
            }
            //if different marker set infowindow to open and reset current marker index
            else {
                this.infoWinOpen = true;
                this.currentMidx = idx;
            }
        },
        getInfoWindowContent: function (marker) {
            return (
                `<div class="card relative">
              <button>
                  <div class="card-body">
                      <img src="https://dubai-fitness.netlify.app/assets/images/mass-events/mass-event-01.png" alt="" class="card-img rounded-t-lg object-cover overflow-hidden">
                      <div class="gym-logo rounded-full absolute top-20 left-6">
                          <img src="https://dubai-fitness.netlify.app/assets/images/dubai-fitness-challenge-logo.png" alt="" class="rounded-full h-16 w-16">
                      </div>
                      <div class="carf-info-box  flex justify-between px-4 pt-8 pb-4 rounded-b-lg">
                          <div class="gym-info w-full">
                              <h3 class="float-left card-title">DUBAI RIDE</h3>
                              <div class="float-right">
                                  <div class="pl-7">
                                      <svg width="27" height="28" viewBox="0 0 27 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                          <path d="M13.7182 0.798828C6.42272 0.798828 0.503906 6.7409 0.503906 14.065C0.503906 21.3892 6.42272 27.3312 13.7182 27.3312C21.0137 27.3312 26.9325 21.3892 26.9325 14.065C26.9325 6.7409 21.0137 0.798828 13.7182 0.798828ZM19.9915 8.454C19.9585 8.57814 19.8926 8.68573 19.8348 8.80159C17.7328 13.0223 15.6307 17.2512 13.5286 21.4719C13.4956 21.5381 13.4626 21.6043 13.4297 21.6706C13.2978 21.9271 13.0999 22.0926 12.7949 22.0347C12.5146 21.985 12.3992 21.7781 12.3498 21.5216C12.086 20.0733 11.8222 18.625 11.5419 17.1768C11.3523 16.2002 11.5831 16.4402 10.6186 16.2499C9.21726 15.9768 7.81587 15.7285 6.41448 15.4637C6.1919 15.4223 5.93636 15.3975 5.82919 15.1492C5.70554 14.8843 5.77148 14.6443 5.98582 14.4623C6.09298 14.3795 6.21663 14.3133 6.34028 14.2554C10.5445 12.145 14.7486 10.0347 18.961 7.92435C19.1342 7.84159 19.2908 7.734 19.4969 7.74228C19.8513 7.74228 20.0986 8.08159 19.9915 8.454Z" fill="#690fad"></path>
                                      </svg>
                                  </div>
                                  <div class="distance-box flex mt-3">
                                      <div class="step mr-2">
                                          <svg width="10" height="13" viewBox="0 0 10 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                                              <path d="M9.33314 5.97737C9.25963 7.18892 9.02215 8.3612 8.43411 9.44934C8.20794 9.86441 8.12313 9.89806 7.67079 9.79149C7.13363 9.66248 6.59083 9.52787 6.05367 9.39886C5.90101 9.3596 5.77096 9.30351 5.72007 9.13524C5.23381 7.40767 5.21685 5.71375 6.16676 4.1208C6.6813 3.2514 7.60294 2.999 8.40019 3.44772C8.82425 3.6889 9.02215 4.09275 9.14089 4.53586C9.25398 5.00702 9.33314 5.48939 9.33314 5.97737Z" fill="black"></path>
                                              <path d="M4.05847 4.10848C4.01889 4.77595 3.97931 5.44903 3.78141 6.09967C3.71356 6.31842 3.60047 6.44182 3.36299 6.49791C2.79191 6.62131 2.22649 6.76714 1.66672 6.91298C1.45751 6.96907 1.3105 6.92419 1.18045 6.75593C0.965593 6.47548 0.818582 6.16698 0.705498 5.84166C0.219232 4.4955 -0.0578255 3.1269 0.3097 1.70222C0.479328 1.05158 0.784657 0.513113 1.51405 0.367279C2.23214 0.210227 2.79191 0.490677 3.21033 1.07962C3.70225 1.75831 3.9058 2.54357 4.00192 3.35687C4.03585 3.60367 4.09239 3.85047 4.05847 4.10848Z" fill="black"></path>
                                              <path d="M6.18389 12.9321C5.55627 12.9321 5.01912 12.2983 5.0587 11.513C5.08697 10.9409 5.29052 10.4249 5.58454 9.93689C5.66936 9.79666 5.76548 9.75179 5.92945 9.80227C6.51184 9.98176 7.09988 10.15 7.68792 10.3239C7.81232 10.3576 7.9254 10.4024 7.90278 10.5651C7.79535 11.3335 7.64834 12.0795 7.02072 12.6292C6.80586 12.8199 6.55707 12.9377 6.18389 12.9321Z" fill="black"></path>
                                              <path d="M4.39812 8.74233C4.39812 9.49954 3.75354 10.1334 3.02414 9.99874C2.53222 9.909 2.22124 9.57246 1.98376 9.163C1.72932 8.71989 1.62754 8.2263 1.54839 7.7271C1.52577 7.56444 1.571 7.46347 1.74063 7.41299C2.33432 7.24472 2.93367 7.07085 3.52171 6.88575C3.67438 6.84088 3.76485 6.86331 3.84966 6.99793C4.17195 7.50835 4.38116 8.05242 4.39812 8.74233Z" fill="black"></path>
                                          </svg>
                                      </div>
                                      <div class="text-xs distance">0.10 mile
                                      </div>
                                  </div>
                              </div>
                              <div class="clear-both"></div>
                              <div class="flex">
                                  <svg class="mr-2" width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                      <path d="M17.3649 5.66116C17.3419 6.47457 17.0278 7.12365 16.3537 7.50981C15.603 7.93705 14.8446 7.89597 14.1705 7.3044C13.4581 6.67997 12.8453 5.94052 12.1942 5.25036C11.5047 4.51911 10.823 3.77966 10.1336 3.04842C10.0263 2.93339 9.9114 2.81836 9.78118 2.74442C9.55903 2.62118 9.32156 2.64582 9.15303 2.85945C8.99217 3.06485 8.96152 3.30312 9.12239 3.54139C9.18367 3.63177 9.25262 3.71393 9.32156 3.78787C10.9762 5.579 12.6231 7.37013 14.2778 9.16126C14.6914 9.60493 14.814 9.61315 15.3043 9.30094C15.6949 9.05445 16.0626 9.11196 16.2848 9.44883C16.5222 9.80212 16.4686 10.1883 16.1469 10.5087C15.3962 11.2482 14.2854 11.24 13.5424 10.4841C12.9219 9.85142 12.3167 9.20234 11.7039 8.56148C11.2826 8.11781 11.2826 8.11781 10.8536 8.57791C10.034 9.45704 9.21431 10.3444 8.387 11.2235C8.27976 11.3386 8.16485 11.4536 8.04229 11.5522C7.7129 11.8069 7.29158 11.7658 7.03879 11.4618C6.80898 11.1824 6.83196 10.7388 7.11539 10.4266C8.01165 9.4324 8.92322 8.45467 9.82714 7.46873C10.2408 7.01684 10.2561 7.00862 9.84246 6.5403C9.30624 5.9323 8.74704 5.34895 8.20315 4.75738C7.49841 3.98506 7.37584 2.84301 7.9044 2.06247C8.53255 1.12583 9.54371 0.862912 10.5089 1.4134C10.7081 1.52842 10.8 1.51199 10.9455 1.33123C11.8265 0.246698 13.0598 0.1974 14.0326 1.19978C14.2242 1.39696 14.4233 1.59415 14.5918 1.81599C14.7834 2.06247 14.9289 2.02961 15.1127 1.80777C15.243 1.64345 15.4038 1.49556 15.5647 1.3641C15.8711 1.12583 16.2388 1.15869 16.4763 1.4134C16.7137 1.67631 16.7521 2.06248 16.5682 2.39934C16.4456 2.61296 16.2771 2.7855 16.0933 2.93339C15.9094 3.0895 15.9018 3.21274 16.0779 3.3935C16.3767 3.70571 16.6678 4.03436 16.9436 4.37944C17.2423 4.73274 17.3802 5.16819 17.3649 5.66116ZM15.9401 5.60365C15.9554 5.43111 15.8328 5.29144 15.7026 5.15176C14.8217 4.2069 13.9331 3.26204 13.0445 2.31718C12.9602 2.23502 12.8683 2.15285 12.7687 2.09534C12.5772 1.98031 12.378 1.98853 12.2018 2.13642C12.0103 2.30074 11.9567 2.51437 12.018 2.76085C12.0486 2.90053 12.1329 3.00734 12.2248 3.10593C13.1211 4.05901 14.0097 5.0203 14.9059 5.97338C14.9825 6.05554 15.0898 6.12949 15.1893 6.17878C15.5494 6.34311 15.9401 6.07197 15.9401 5.60365Z" fill="black"></path>
                                      <path d="M2.89547 8.43013C3.2555 8.42192 3.70746 8.66019 4.08281 9.06278C5.86 10.9854 7.63719 12.908 9.40672 14.847C10.1115 15.6275 10.1498 16.7942 9.53694 17.6158C8.91646 18.4457 7.88232 18.6511 6.99372 18.0924C6.77158 17.9527 6.64135 17.9445 6.48815 18.1745C5.92894 19.0455 4.48881 19.2426 3.66149 18.3964C3.38572 18.117 3.10229 17.8377 2.83418 17.5419C2.68098 17.3776 2.56607 17.3693 2.42819 17.5583C2.28264 17.7555 2.12944 17.9363 1.93027 18.0677C1.60853 18.2896 1.24084 18.2485 0.988051 17.9609C0.750581 17.698 0.735261 17.3201 0.96507 16.9832C1.07231 16.8271 1.18722 16.6792 1.3251 16.5559C1.57789 16.3341 1.60087 16.1534 1.33276 15.9069C1.04167 15.6439 0.765902 15.3564 0.543753 15.0195C-0.0843911 14.1075 0.00753246 12.9162 0.796543 12.1685C1.04167 11.9384 1.10296 11.7988 0.934429 11.4455C0.252662 10.0076 1.23318 8.3644 2.89547 8.43013ZM8.51812 16.3012C8.54111 16.063 8.37258 15.9069 8.21937 15.7425C6.56475 13.9514 4.91778 12.1685 3.27082 10.3774C2.87248 9.94191 2.53543 9.85975 2.29796 10.1309C2.05283 10.4185 2.12178 10.7471 2.53543 11.1908C4.13643 12.9326 5.73744 14.6744 7.33844 16.4163C7.48398 16.5724 7.62187 16.7367 7.81338 16.8189C8.15809 16.975 8.51046 16.7203 8.51812 16.3012ZM5.51529 16.7367C5.52295 16.5888 5.3774 16.4327 5.23186 16.2766C4.3739 15.3564 3.52361 14.428 2.66566 13.5077C2.58139 13.4174 2.50479 13.327 2.40521 13.2695C2.16774 13.1298 1.93793 13.138 1.73876 13.3516C1.53959 13.5653 1.52427 13.8117 1.67748 14.0582C1.76174 14.1897 1.86898 14.3129 1.97623 14.428C2.68098 15.1838 3.37806 15.9397 4.08281 16.6956C4.26666 16.8928 4.44285 17.09 4.63435 17.2708C4.80288 17.4351 5.00205 17.4515 5.20888 17.3447C5.40804 17.2543 5.50763 17.0736 5.51529 16.7367Z" fill="black"></path>
                                  </svg>
                                  <svg width="21" height="22" viewBox="0 0 21 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                      <path d="M6.93781 12.4968C6.71606 12.7002 6.54753 12.8573 6.37013 13.0144C5.89114 13.4488 5.3412 13.6614 4.71142 13.7168C3.91311 13.7908 3.11481 13.7908 2.3165 13.6983C1.30531 13.5874 0.666665 12.8111 0.719886 11.7205C0.764236 10.7408 1.50045 10.0292 2.50277 10.0938C3.45187 10.1493 4.07278 9.75188 4.54289 8.92008C5.06623 8.0051 5.66939 7.13632 6.47657 6.46164C6.83137 6.16588 7.22165 5.94407 7.65629 5.81468C8.13527 5.6668 8.16188 5.61135 7.93126 5.14924C7.33697 3.92926 7.38132 2.737 8.17075 1.63718C8.93358 0.602042 9.96251 0.167655 11.1777 0.380227C12.455 0.602042 13.2799 1.43385 13.6702 2.71852C13.9363 3.58729 13.7944 4.40985 13.3597 5.1862C13.1557 5.54665 13.2001 5.68529 13.5815 5.78695C14.4419 6.02725 15.116 6.5633 15.6482 7.27496C16.2159 8.04206 16.7481 8.82766 17.2803 9.62249C17.4932 9.93673 17.7416 10.0938 18.1141 10.0661C18.398 10.0476 18.6907 10.0569 18.9745 10.0661C19.8172 10.1031 20.5445 10.7963 20.5977 11.6188C20.6687 12.7371 20.1808 13.4673 19.2229 13.6521C18.1762 13.8554 17.1207 13.837 16.074 13.6244C15.6216 13.532 15.2313 13.3009 14.912 12.9682C14.7612 12.8111 14.637 12.6262 14.504 12.4599C14.4685 12.4784 14.4242 12.5061 14.3887 12.5246C14.3887 12.885 14.3887 13.2455 14.3887 13.6059C14.3887 14.0495 14.3975 14.4932 14.3887 14.9368C14.3887 15.2233 14.504 15.3065 14.7701 15.251C15.3733 15.1309 15.9764 14.983 16.6062 15.0015C18.1407 15.0477 19.3825 16.3416 19.4358 17.996C19.489 19.5672 18.3625 20.8981 16.8368 21.0552C16.5796 21.0829 16.3224 21.0921 16.074 21.0921C12.5082 21.0921 8.95132 21.0921 5.38555 21.0921C4.8356 21.0921 4.27679 21.0921 3.74458 20.8796C2.45842 20.362 1.70446 18.9387 1.94396 17.4877C2.17458 16.1013 3.39865 15.02 4.76464 15.0015C5.3412 14.9922 5.90888 15.0754 6.4677 15.2233C6.8225 15.3157 6.92894 15.2418 6.92894 14.8629C6.94668 14.0957 6.93781 13.3194 6.93781 12.4968ZM8.17075 12.848C8.17075 13.6521 8.17962 14.447 8.17075 15.251C8.17075 15.5375 8.27719 15.7131 8.53443 15.8056C9.67867 16.2492 10.8318 16.4895 12.0292 16.0274C12.2421 15.9442 12.4639 15.898 12.6768 15.8425C13.067 15.7316 13.2001 15.5653 13.1823 15.1586C13.1291 13.6521 13.1735 12.1364 13.1646 10.6299C13.1646 10.4543 13.1823 10.2694 13.2267 10.1031C13.342 9.67795 13.821 9.52083 14.1492 9.80734C14.2734 9.91824 14.3798 10.0661 14.4862 10.2048C14.8677 10.7408 15.2402 11.2861 15.6127 11.8221C15.8434 12.1549 16.145 12.3952 16.5352 12.4321C17.3335 12.5061 18.1319 12.4876 18.9302 12.4414C19.2317 12.4229 19.418 12.1826 19.418 11.8868C19.418 11.5726 19.2584 11.397 18.9568 11.3508C18.5665 11.2769 18.1673 11.2953 17.7771 11.3231C17.2005 11.36 16.8102 11.1013 16.4909 10.6207C15.9853 9.85355 15.4176 9.12341 14.9209 8.34706C14.2556 7.29344 13.3154 6.8683 12.1357 6.82209C11.1245 6.78512 10.1133 6.84057 9.10211 6.84057C7.99335 6.84057 7.13295 7.30268 6.49431 8.24539C5.91775 9.09568 5.31459 9.93673 4.73803 10.787C4.48967 11.1475 4.18809 11.3046 3.75345 11.2676C3.34543 11.2306 2.91967 11.2122 2.51164 11.3046C2.09475 11.397 1.93509 11.5911 1.97057 11.9793C2.00605 12.3027 2.21006 12.4691 2.60921 12.4784C3.23012 12.4876 3.84215 12.4784 4.46306 12.4876C4.97752 12.4876 5.38555 12.2658 5.71374 11.8591C5.82018 11.7205 5.91775 11.5726 6.01532 11.434C6.34352 10.9534 6.67171 10.4728 7.00877 10.0014C7.1773 9.76112 7.40793 9.63173 7.70064 9.70567C8.00222 9.78885 8.11753 10.0292 8.15301 10.3249C8.17075 10.4451 8.17075 10.5652 8.17075 10.6946C8.17962 11.397 8.17075 12.1271 8.17075 12.848ZM8.81827 19.8722C10.0512 19.8722 11.293 19.8722 12.526 19.8722C12.6945 19.8722 12.863 19.8537 13.0316 19.7982C13.3065 19.6966 13.4928 19.5117 13.5194 19.2067C13.5549 18.874 13.4485 18.6152 13.1557 18.4581C13.0049 18.3749 12.8453 18.3195 12.6768 18.2732C10.6544 17.691 8.632 17.118 6.60962 16.5449C6.02419 16.3786 5.4299 16.24 4.81786 16.2584C3.57605 16.3046 2.77774 17.5708 3.24786 18.7354C3.59379 19.5672 4.25905 19.8722 5.0751 19.8814C6.32578 19.8814 7.56759 19.8722 8.81827 19.8722ZM13.0848 16.9978C13.3686 17.1549 13.5815 17.2566 13.7766 17.3767C14.4242 17.7557 14.7435 18.3195 14.708 19.0958C14.6991 19.2622 14.6991 19.4285 14.708 19.5949C14.7169 19.752 14.7967 19.8537 14.9386 19.8537C15.595 19.8537 16.2603 19.9461 16.9078 19.7705C17.7682 19.5394 18.2383 18.8001 18.1939 17.8389C18.1496 17.044 17.5642 16.4156 16.7215 16.2954C15.4708 16.1198 14.3532 16.7205 13.0848 16.9978ZM10.6632 1.62793C9.52787 1.62793 8.76505 2.42277 8.77392 3.58729C8.78279 4.69636 9.63432 5.60211 10.6721 5.60211C11.7099 5.60211 12.6147 4.64091 12.6058 3.56881C12.5881 2.44125 11.772 1.61869 10.6632 1.62793Z" fill="black"></path>
                                  </svg>
                              </div>
                              <div class="flex mt-4 items-center">
                                  <svg class="mr-2 location-icon" width="15" height="20" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                      <path d="M5.29953 0.624512C2.7249 0.624512 0.630859 2.72678 0.630859 5.31153C0.630859 6.16278 1.01191 7.07606 1.02564 7.11741C1.14922 7.41035 1.38952 7.86527 1.56459 8.13064L4.76744 12.9969C4.89789 13.1968 5.09356 13.3105 5.29953 13.3105C5.50551 13.3105 5.70118 13.1968 5.83163 12.9969L9.03447 8.12719C9.20955 7.86182 9.44985 7.4069 9.57343 7.11397C9.5906 7.07606 9.96821 6.15933 9.96821 5.30808C9.96821 2.72678 7.87417 0.624512 5.29953 0.624512ZM5.29953 7.79289C3.93669 7.79289 2.82788 6.67973 2.82788 5.31153C2.82788 3.94334 3.93669 2.83017 5.29953 2.83017C6.66237 2.83017 7.77119 3.94334 7.77119 5.31153C7.77119 6.67973 6.66237 7.79289 5.29953 7.79289Z" fill="black"></path>
                                  </svg>
                                  <p class="text-xs location capitalize">old
                                      Sports Stars Complex,
                                      Next
                                      door To Arabian Center.</p>
                              </div>
                          </div>
                      </div>
                  </div>
              </button>
          </div>`);
        },
    }
};
</script>

<style scoped>
#map {
  background:gray;
  height:100vh;
}
</style>